## 如何编写Go

作为Go语言的入门教程，本文将演示在Go模块中开发一个简单的包。同时将介绍如何go语言工具，获取、构建与安装Go模块、包、命令。

### 代码组织结构

```
dev/
|- my_repo/
   |- go.mod
   |- package1_subdir/
   |- package2_subdir/
   |- submodule/
      |- go.mod
      |- ...  
```

Go程序代码以包为单位组成。一个包是在相同路径下，会被编译到一起的源文件集合。在一个源文件中定义的函数，类型，变量，常量等对所属包下其他源文件可见。

一个仓库包含一个或多个模块。模块是具有关联关系，一起发布的Go包的集合。一般一个Go仓库只包含一个模块，它位于仓库的根目录。go.mod文件声明了模块路径——该模块中所有包的导入路径前缀。模块的目录中包含包go.mod文件，包以及子目录。

自己开发的Go程序不需要推送到远程仓库，模块可以在本地定义为不属于任何仓库。但将代码组织成包含在仓库中的结构形式更好。

模块的路径不仅作为其包的导入路径前缀，还作为go命令搜索下载的指示符。例如，要下载golang.org/x/tools模块，go命令会和https://golang.org/x/tools/仓库建立联系。

导入路径是一串用于导入包的字符串。包的导入路径格式为模块路径加上包在模块中的子路径。例如github.com/goolgle/go-cmp模块的cmp/目录中包含了一个包，则该包的导入路径为github.com/google/go-cmp/cmp。在标准库中的包没有模块路径前缀。

### 第一个Go程序

1. 新建目录，作为模块的根目录。
2. 使用`go init <module path>`初始化模块，创建go.mod文件
3. 在模块目录中创建源文件，编写代码

### 从模块中导入包

1. 为模块创建包。在模块根目录下创建一个子目录`packany`。进入该子目录并创建go源文件。
2. 编译测试包。
3. 在要使用该包的源文件中导入该包。格式为`<module path>/<package subdir>`。


### 从远程仓库导入包

1. 在源文件中按格式导入包。
2. go命令行将自动下载远程模块，并记录其地址和版本到go.mod中。
3. 远程模块会被下载到GOPATH指定的路径的pkg/mod子目录中。
4. `go clean -modcache`可删除下载的远程模块。

### 测试

Go有一个轻量的测试框架，结合了go test命令以及testing包。

创建一个以`_test.go`结尾的源文件表示这是测试文件。在文件中包含签名形式为`func Test<XXX>(t *testing.T)`的函数，表示这是测试`<XXX>`函数的测试函数。

运行`go test`即可。

